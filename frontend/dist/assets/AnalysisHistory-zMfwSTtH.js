import{j as e,m as d,C as f,d as N,p as u,q as v,M as w}from"./vendor-ui-CKvTnmtk.js";import{a as x}from"./vendor-react-CGlDSCWT.js";import{d as b,e as A}from"./index-DUVn1LJX.js";function C(){const{data:a,loading:h,error:l,refetch:m}=b(),[r,i]=x.useState(null),[y,c]=x.useState(null),p=async(s,t)=>{if(t.stopPropagation(),!!confirm("Are you sure you want to delete this analysis? This cannot be undone.")){c(s);try{await A(s),await m(),r===s&&i(null)}catch(o){alert("Failed to delete analysis: "+o.message)}finally{c(null)}}};if(h)return e.jsx("div",{className:"text-gray-500 font-mono text-sm p-8",children:"Loading history..."});if(l)return e.jsxs("div",{className:"text-sc-danger font-mono text-sm p-8",children:["Error: ",l]});const n=(a==null?void 0:a.history)||[];return n.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display font-bold text-2xl tracking-wider text-white",children:"ANALYSIS HISTORY"}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mt-1",children:"Past AI fleet analyses"})]}),e.jsx("div",{className:"glow-line"}),e.jsxs("div",{className:"panel p-12 text-center",children:[e.jsx(d,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No analyses yet. Generate your first AI fleet analysis!"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display font-bold text-2xl tracking-wider text-white",children:"ANALYSIS HISTORY"}),e.jsxs("p",{className:"text-xs font-mono text-gray-500 mt-1",children:["Past AI fleet analyses (",n.length," total)"]})]}),e.jsx("div",{className:"glow-line"}),e.jsx("div",{className:"space-y-3",children:n.map(s=>{const t=r===s.id,g=new Date(s.created_at).toLocaleString("en-NZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"panel",children:[e.jsxs("button",{onClick:()=>i(t?null:s.id),className:"w-full p-4 flex items-center justify-between hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4 text-left",children:[t?e.jsx(f,{className:"w-4 h-4 text-sc-accent flex-shrink-0"}):e.jsx(N,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-3.5 h-3.5 text-gray-500"}),e.jsx("span",{className:"text-sm font-mono text-gray-400",children:g})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-3.5 h-3.5 text-sc-accent"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.provider," / ",s.model]})]}),e.jsxs("span",{className:"text-xs text-gray-600",children:[s.vehicle_count," ships"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:j=>p(s.id,j),disabled:y===s.id,className:"p-1.5 rounded hover:bg-sc-danger/10 text-gray-500 hover:text-sc-danger transition-colors disabled:opacity-50",title:"Delete this analysis",children:e.jsx(v,{className:"w-3.5 h-3.5"})}),e.jsx("span",{className:"text-xs text-gray-600",children:t?"Hide":"View"})]})]}),t&&e.jsx("div",{className:"border-t border-sc-border p-5",children:e.jsx("div",{className:"prose prose-invert prose-sm max-w-none text-gray-300",children:e.jsx(w,{children:s.analysis})})})]},s.id)})})]})}export{C as default};
