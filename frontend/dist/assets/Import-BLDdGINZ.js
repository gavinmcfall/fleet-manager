import{j as e,c as E,q as j,r as J,A as O,F as C,b as H,X as A}from"./vendor-ui-BoY7sAdT.js";import{a as r}from"./vendor-react-CGlDSCWT.js";import{f as R,s as F,i as L}from"./index-CD2RGnxz.js";function q(){var k;const{data:l,refetch:u}=R(),[p,c]=r.useState(null),[x,g]=r.useState(null),[a,y]=r.useState(null),[T,i]=r.useState(null),[o,v]=r.useState(""),[b,h]=r.useState(!1),w=r.useRef(null),f=(l==null?void 0:l.vehicles)||0,m=((k=l==null?void 0:l.config)==null?void 0:k.fleetyards_user)||"";r.useEffect(()=>{m&&!o&&v(m)},[m]);const S=async()=>{const s=o.trim();if(s)try{await F(s),h(!0),setTimeout(()=>h(!1),2e3),u()}catch(d){i(d.message)}},X=async s=>{var I;const d=(I=s.target.files)==null?void 0:I[0];if(d){c("parsing"),i(null),g(null);try{const N=await d.text(),n=JSON.parse(N);if(!Array.isArray(n))throw new Error("Expected a JSON array of ship entries");if(n.filter(t=>t.ship_code||t.name||t.pledge_id).length===0)throw new Error("No valid ship entries found in the JSON");y({filename:d.name,total:n.length,lti:n.filter(t=>t.lti).length,nonLTI:n.filter(t=>!t.lti).length,warbond:n.filter(t=>t.warbond).length,data:n}),c(null)}catch(N){i(N.message),c("error")}}},U=async()=>{if(a!=null&&a.data){c("importing"),i(null);try{const s=await L(a.data);g(s),c("success"),y(null),setTimeout(u,2e3)}catch(s){i(s.message),c("error")}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display font-bold text-2xl tracking-wider text-white",children:"IMPORT HANGAR"}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mt-1",children:"Import your fleet from HangarXplor to populate ships, insurance, and pledge data"})]}),e.jsx("div",{className:"glow-line"}),e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(E,{className:"w-3.5 h-3.5"}),"FleetYards Username"]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Your username on ",e.jsx("span",{className:"font-mono text-gray-400",children:"fleetyards.net"})," â€” used for reference data sync (ship images, specs). Not required for HangarXplor import."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:s=>{v(s.target.value),h(!1)},onKeyDown:s=>s.key==="Enter"&&S(),placeholder:"e.g. NZVengeance",className:"flex-1 bg-sc-darker border border-sc-border rounded px-3 py-2 text-sm font-mono text-gray-300 placeholder:text-gray-600 focus:outline-none focus:border-sc-accent/50"}),e.jsxs("button",{onClick:S,disabled:!o.trim()||o.trim()===m,className:"btn-primary flex items-center gap-2 disabled:opacity-30",children:[b?e.jsx(j,{className:"w-3.5 h-3.5"}):e.jsx(J,{className:"w-3.5 h-3.5"}),b?"Saved":"Save"]})]})]})]}),f>0&&e.jsxs("div",{className:"panel p-4 flex items-center gap-3 border-l-2 border-l-sc-accent",children:[e.jsx(j,{className:"w-4 h-4 text-sc-accent shrink-0"}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Currently loaded: ",e.jsxs("span",{className:"text-white font-medium",children:[f," ships"]})]})]}),f>0&&e.jsxs("div",{className:"panel p-3 flex items-start gap-2 border-l-2 border-l-sc-warn",children:[e.jsx(O,{className:"w-4 h-4 text-sc-warn shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Importing will ",e.jsx("span",{className:"text-sc-warn font-medium",children:"replace"})," your current fleet data with the new import."]})]}),e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),"HangarXplor Import"]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Upload a JSON export from the HangarXplor browser extension. Includes full pledge and insurance details. Ship data is automatically enriched from the reference database (images, specs, manufacturer info)."}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-sc-accent"}),e.jsx("span",{children:"Ship names, manufacturer, images (from reference DB)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-sc-accent"}),e.jsx("span",{children:"LTI / insurance type, warbond status"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-sc-accent"}),e.jsx("span",{children:"Pledge name, date, and cost"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-sc-accent"}),e.jsx("span",{children:"Custom ship names"})]})]}),e.jsxs("div",{className:"p-4 border-2 border-dashed border-sc-border hover:border-sc-accent/30 transition-colors cursor-pointer rounded text-center",onClick:()=>{var s;return(s=w.current)==null?void 0:s.click()},children:[e.jsx("input",{ref:w,type:"file",accept:".json",className:"hidden",onChange:X}),e.jsx(H,{className:"w-6 h-6 mx-auto text-gray-600 mb-2"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Drop ",e.jsx("span",{className:"text-gray-300 font-mono",children:".json"})," file or click to browse"]})]})]})]}),a&&e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),a.filename]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-white",children:a.total}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Total Ships"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-lti",children:a.lti}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"LTI"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-warn",children:a.nonLTI}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Non-LTI"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-success",children:a.warbond}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Warbond"})]})]}),e.jsxs("button",{onClick:U,className:"btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," Import ",a.total," Ships"]})]})]}),p==="importing"&&e.jsxs("div",{className:"panel p-5 flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-sc-accent border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Importing..."})]}),p==="success"&&x&&e.jsx("div",{className:"panel border-l-2 border-l-sc-success",children:e.jsxs("div",{className:"p-5 flex items-center gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-sc-success"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white font-medium",children:"Import complete!"}),x.imported!=null&&e.jsxs("span",{className:"text-sm text-gray-400 ml-2",children:[x.imported," of ",x.total," entries imported"]})]})]})}),p==="error"&&e.jsxs("div",{className:"panel p-5 flex items-center gap-3 border-l-2 border-l-sc-danger",children:[e.jsx(A,{className:"w-5 h-5 text-sc-danger"}),e.jsx("span",{className:"text-sm text-sc-danger",children:T})]}),e.jsxs("details",{className:"panel",children:[e.jsx("summary",{className:"panel-header cursor-pointer select-none hover:text-gray-300 transition-colors",children:"How to export from HangarXplor"}),e.jsx("div",{className:"p-5",children:e.jsxs("ol",{className:"space-y-2 text-sm text-gray-400",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"1."}),"Install the HangarXplor browser extension from"," ",e.jsx("a",{href:"https://hangarxplor.space/",target:"_blank",rel:"noopener noreferrer",className:"text-sc-accent hover:underline",children:"https://hangarxplor.space/"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"2."}),"Go to ",e.jsx("span",{className:"font-mono text-gray-300",children:"robertsspaceindustries.com"})," and log in"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"3."}),"Navigate to ",e.jsx("span",{className:"font-mono text-gray-300",children:"My Hangar"})," and wait for the page to fully load"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"4."}),"Click the HangarXplor icon and export as JSON"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"5."}),"Upload the exported JSON file above"]})]})})]})]})}export{q as default};
