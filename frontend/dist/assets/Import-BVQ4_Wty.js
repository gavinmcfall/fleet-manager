import{j as e,c as J,r as v,s as O,A as I,G as C,t as p,R as G,F as T,b as H,m as R,X as M}from"./vendor-ui-CKvTnmtk.js";import{a as x}from"./vendor-react-CGlDSCWT.js";import{f as V,s as D,t as W,h as $,i as q}from"./index-DUVn1LJX.js";function Q(){var Y;const{data:n,refetch:f}=V(),[l,t]=x.useState(null),[a,h]=x.useState(null),[r,j]=x.useState(null),[A,c]=x.useState(null),[g,w]=x.useState(""),[k,N]=x.useState(!1),S=x.useRef(null),d=(n==null?void 0:n.hangar_source)||"",y=(n==null?void 0:n.vehicles)||0,o=((Y=n==null?void 0:n.config)==null?void 0:Y.fleetyards_user)||"";x.useEffect(()=>{o&&!g&&w(o)},[o]);const F=async()=>{const s=g.trim();if(s)try{await D(s),N(!0),setTimeout(()=>N(!1),2e3),f()}catch(u){c(u.message)}},X=async()=>{if(!(d==="hangarxplor"&&!window.confirm(`⚠️ WARNING: You currently have HangarXplor data loaded.

Syncing from FleetYards will REPLACE all your existing data, including:
• Insurance details (LTI status)
• Pledge information (costs, dates, warbond status)
• Custom ship names

FleetYards does not include this data, so it will be lost.

Are you sure you want to continue?`))){t("syncing"),c(null),h(null),j(null);try{const s=await W();h({message:s.message,source:"fleetyards"}),t("success"),setTimeout(f,3e3)}catch(s){c(s.message),t("error")}}},_=async()=>{t("enriching"),c(null),h(null);try{const s=await $();h({message:s.message,source:"enrich"}),t("success"),setTimeout(f,3e3)}catch(s){c(s.message),t("error")}},L=async s=>{var E;const u=(E=s.target.files)==null?void 0:E[0];if(u){t("parsing"),c(null),h(null);try{const b=await u.text(),m=JSON.parse(b);if(!Array.isArray(m))throw new Error("Expected a JSON array of ship entries");if(m.filter(i=>i.ship_code||i.name||i.pledge_id).length===0)throw new Error("No valid ship entries found in the JSON");j({filename:u.name,total:m.length,lti:m.filter(i=>i.lti).length,nonLTI:m.filter(i=>!i.lti).length,warbond:m.filter(i=>i.warbond).length,data:m}),t(null)}catch(b){c(b.message),t("error")}}},U=async()=>{if(r!=null&&r.data){t("importing"),c(null);try{const s=await q(r.data);h({...s,source:"hangarxplor"}),t("success"),j(null),setTimeout(f,2e3)}catch(s){c(s.message),t("error")}}},P={fleetyards:"FleetYards",hangarxplor:"HangarXplor"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display font-bold text-2xl tracking-wider text-white",children:"IMPORT HANGAR"}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mt-1",children:"Choose a source to populate your fleet — only one source is active at a time"})]}),e.jsx("div",{className:"glow-line"}),e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(J,{className:"w-3.5 h-3.5"}),"FleetYards Username"]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Your hangar username on ",e.jsx("span",{className:"font-mono text-gray-400",children:"fleetyards.net"})," — used for syncing and enrichment."," ",e.jsx("span",{className:"text-sc-warn",children:"Your hangar must be set to public"})," during sync (you can make it private again after)."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:s=>{w(s.target.value),N(!1)},onKeyDown:s=>s.key==="Enter"&&F(),placeholder:"e.g. NZVengeance",className:"flex-1 bg-sc-darker border border-sc-border rounded px-3 py-2 text-sm font-mono text-gray-300 placeholder:text-gray-600 focus:outline-none focus:border-sc-accent/50"}),e.jsxs("button",{onClick:F,disabled:!g.trim()||g.trim()===o,className:"btn-primary flex items-center gap-2 disabled:opacity-30",children:[k?e.jsx(v,{className:"w-3.5 h-3.5"}):e.jsx(O,{className:"w-3.5 h-3.5"}),k?"Saved":"Save"]})]})]})]}),y>0&&e.jsxs("div",{className:"panel p-4 flex items-center gap-3 border-l-2 border-l-sc-accent",children:[e.jsx(v,{className:"w-4 h-4 text-sc-accent shrink-0"}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Currently loaded: ",e.jsxs("span",{className:"text-white font-medium",children:[y," ships"]})," from"," ",e.jsx("span",{className:"text-sc-accent font-medium",children:P[d]||"Unknown"})]})]}),y>0&&e.jsxs("div",{className:"panel p-3 flex items-start gap-2 border-l-2 border-l-sc-warn",children:[e.jsx(I,{className:"w-4 h-4 text-sc-warn shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Importing from a different source will ",e.jsx("span",{className:"text-sc-warn font-medium",children:"replace"})," your current hangar data. Enrichment only adds to existing data."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:`panel transition-all ${d==="fleetyards"?"ring-1 ring-sc-accent/30":""}`,children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),"FleetYards Public Hangar",d==="fleetyards"&&e.jsx("span",{className:"ml-auto text-[10px] font-mono bg-sc-accent/20 text-sc-accent px-2 py-0.5 rounded",children:"ACTIVE"})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Syncs your public hangar directly from FleetYards."}),e.jsx("div",{className:"p-3 rounded bg-blue-500/10 border border-blue-500/20 text-xs text-blue-300 space-y-1",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-3.5 h-3.5 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Requires public hangar:"})," Your hangar on"," ",e.jsx("span",{className:"font-mono",children:"fleetyards.net"})," must be set to public during sync. You can make it private again immediately after."]})]})}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-sc-accent"}),e.jsx("span",{children:"Ship names, manufacturer, paint/livery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-sc-accent"}),e.jsx("span",{children:"Loaner detection"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-gray-600",children:"No insurance/pledge data"})]})]}),o?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-mono text-gray-500",children:["Syncing as: ",e.jsx("span",{className:"text-gray-300",children:o})]}),e.jsx("button",{onClick:X,disabled:l==="syncing",className:"btn-primary w-full flex items-center justify-center gap-2",children:l==="syncing"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3.5 h-3.5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Syncing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-3.5 h-3.5"}),d==="fleetyards"?"Re-sync from FleetYards":"Sync from FleetYards"]})})]}):e.jsx("div",{className:"p-3 rounded bg-sc-warn/10 border border-sc-warn/20",children:e.jsxs("p",{className:"text-xs text-sc-warn flex items-center gap-2",children:[e.jsx(I,{className:"w-3.5 h-3.5 shrink-0"}),"Enter your FleetYards username above to enable"]})})]})]}),e.jsxs("div",{className:`panel transition-all ${d==="hangarxplor"?"ring-1 ring-sc-accent/30":""}`,children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(T,{className:"w-3.5 h-3.5"}),"HangarXplor Import",d==="hangarxplor"&&e.jsx("span",{className:"ml-auto text-[10px] font-mono bg-sc-accent/20 text-sc-accent px-2 py-0.5 rounded",children:"ACTIVE"})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Upload a JSON export from the HangarXplor browser extension. Includes full pledge and insurance details."}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-sc-accent"}),e.jsx("span",{children:"Ship names, manufacturer"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-sc-accent"}),e.jsx("span",{children:"LTI / insurance status, warbond"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-3 h-3 text-sc-accent"}),e.jsx("span",{children:"Pledge name, date, and cost"})]})]}),e.jsxs("div",{className:"p-4 border-2 border-dashed border-sc-border hover:border-sc-accent/30 transition-colors cursor-pointer rounded text-center",onClick:()=>{var s;return(s=S.current)==null?void 0:s.click()},children:[e.jsx("input",{ref:S,type:"file",accept:".json",className:"hidden",onChange:L}),e.jsx(H,{className:"w-6 h-6 mx-auto text-gray-600 mb-2"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Drop ",e.jsx("span",{className:"text-gray-300 font-mono",children:".json"})," file or click to browse"]})]})]})]})]}),d==="hangarxplor"&&o&&e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(R,{className:"w-3.5 h-3.5"}),"Enrich from FleetYards"]}),e.jsxs("div",{className:"p-5 space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Pull supplementary data from your FleetYards hangar to enhance your HangarXplor import. This adds loaner flags, paint/livery names, and improves ship database matching — without replacing your pledge and insurance data."}),e.jsxs("div",{className:"p-2.5 rounded bg-blue-500/10 border border-blue-500/20 text-xs text-blue-300",children:[e.jsx("span",{className:"font-medium",children:"Note:"})," Your FleetYards hangar must be public during enrichment. You can make it private again after."]}),e.jsx("button",{onClick:_,disabled:l==="enriching",className:"btn-primary flex items-center justify-center gap-2",children:l==="enriching"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3.5 h-3.5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enriching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-3.5 h-3.5"}),"Enrich from FleetYards (",o,")"]})})]})]}),r&&e.jsxs("div",{className:"panel",children:[e.jsxs("div",{className:"panel-header flex items-center gap-2",children:[e.jsx(T,{className:"w-3.5 h-3.5"}),r.filename]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-white",children:r.total}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Total Ships"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-lti",children:r.lti}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"LTI"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-warn",children:r.nonLTI}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Non-LTI"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-display font-bold text-sc-success",children:r.warbond}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Warbond"})]})]}),e.jsxs("button",{onClick:U,className:"btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(H,{className:"w-4 h-4"})," Import ",r.total," Ships"]})]})]}),(l==="importing"||l==="enriching")&&e.jsxs("div",{className:"panel p-5 flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-sc-accent border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-gray-300",children:l==="enriching"?"Enriching from FleetYards...":"Importing..."})]}),l==="success"&&a&&e.jsxs("div",{className:"panel border-l-2 border-l-sc-success",children:[e.jsxs("div",{className:"p-5 flex items-center gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-sc-success"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-white font-medium",children:a.source==="fleetyards"?"Hangar sync started!":a.source==="enrich"?"Enrichment complete!":"Import complete!"}),a.imported!=null&&e.jsxs("span",{className:"text-sm text-gray-400 ml-2",children:[a.imported," of ",a.total," entries imported"]})]})]}),a.source==="enrich"&&a.enriched!=null&&e.jsxs("div",{className:"px-5 pb-5",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-3",children:[e.jsxs("div",{className:"bg-sc-darker rounded p-3 text-center",children:[e.jsx("div",{className:"text-lg font-display font-bold text-sc-success",children:a.enriched}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Enriched"})]}),a.loaners_added>0&&e.jsxs("div",{className:"bg-sc-darker rounded p-3 text-center",children:[e.jsx("div",{className:"text-lg font-display font-bold text-sc-accent",children:a.loaners_added}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Loaners"})]}),a.paints_added>0&&e.jsxs("div",{className:"bg-sc-darker rounded p-3 text-center",children:[e.jsx("div",{className:"text-lg font-display font-bold text-sc-accent",children:a.paints_added}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Paints"})]}),a.slugs_improved>0&&e.jsxs("div",{className:"bg-sc-darker rounded p-3 text-center",children:[e.jsx("div",{className:"text-lg font-display font-bold text-sc-accent",children:a.slugs_improved}),e.jsx("div",{className:"text-xs font-mono text-gray-500",children:"Slug Matches"})]})]}),a.skipped>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:[a.skipped," ship",a.skipped!==1?"s":""," couldn't be matched with FleetYards data"]})]})]}),l==="error"&&e.jsxs("div",{className:"panel p-5 flex items-center gap-3 border-l-2 border-l-sc-danger",children:[e.jsx(M,{className:"w-5 h-5 text-sc-danger"}),e.jsx("span",{className:"text-sm text-sc-danger",children:A})]}),e.jsxs("details",{className:"panel",children:[e.jsx("summary",{className:"panel-header cursor-pointer select-none hover:text-gray-300 transition-colors",children:"How to export from HangarXplor"}),e.jsx("div",{className:"p-5",children:e.jsxs("ol",{className:"space-y-2 text-sm text-gray-400",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"1."}),"Install the HangarXplor browser extension from"," ",e.jsx("a",{href:"https://hangarxplor.space/",target:"_blank",rel:"noopener noreferrer",className:"text-sc-accent hover:underline",children:"https://hangarxplor.space/"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"2."}),"Go to ",e.jsx("span",{className:"font-mono text-gray-300",children:"robertsspaceindustries.com"})," and log in"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"3."}),"Navigate to ",e.jsx("span",{className:"font-mono text-gray-300",children:"My Hangar"})," and wait for the page to fully load"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"4."}),"Click the HangarXplor icon and export as JSON"]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-sc-accent font-mono font-bold shrink-0",children:"5."}),"Upload the exported JSON file above"]})]})})]})]})}export{Q as default};
